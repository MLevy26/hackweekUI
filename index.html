<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Content Compass</title>
    <style>
        /* Keeping the original styles from ORIGINAL_UI_MARCH_2025 */
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            background-color: #F5F7FA;
            margin: 0;
            padding: 20px;
            color: #2C3E50;
            line-height: 1.6;
        }

        .post-form-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 30px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }

        h2 {
            font-size: 24px;
            font-weight: 500;
            margin-bottom: 24px;
            color: #2C3E50;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
            color: #2C3E50;
        }

        .form-control {
            width: 100%;
            padding: 8px 12px;
            font-size: 14px;
            border: 1px solid #E0E0E0;
            border-radius: 4px;
            background-color: #FFFFFF;
            box-sizing: border-box;
            color: #2C3E50;
            margin-bottom: 16px;
        }

        select.form-control {
            appearance: none;
            background-image: url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23007CB2%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.4-12.8z%22%2F%3E%3C%2Fsvg%3E");
            background-repeat: no-repeat;
            background-position: right 12px center;
            background-size: 8px;
            padding-right: 30px;
        }

        .search-button {
            background-color: #3B82F6;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 8px 16px;
            font-size: 14px;
            cursor: pointer;
        }

        .search-summary {
            border-left: 4px solid #3B82F6;
            padding: 8px 12px;
            margin: 20px 0;
            font-size: 14px;
            color: #2C3E50;
            background-color: #F8FAFC;
        }

        .result-item {
            padding: 20px;
            border: 1px solid #E5E7EB;
            border-radius: 8px;
            margin-bottom: 16px;
            background-color: #FFFFFF;
        }

        .result-section {
            font-size: 16px;
            font-weight: 500;
            color: #2C3E50;
            margin-bottom: 12px;
        }

        .editable-content {
            padding: 12px;
            border: 1px solid #E5E7EB;
            border-radius: 4px;
            margin: 12px 0;
            font-size: 14px;
            line-height: 1.6;
            min-height: 80px;
        }

        .result-type {
            font-size: 12px;
            color: #6B7280;
            margin: 8px 0;
        }

        .button-group {
            margin-top: 12px;
        }

        .save-button {
            background-color: #10B981;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 6px 12px;
            font-size: 14px;
            cursor: pointer;
            margin-right: 8px;
        }

        .export-button {
            background-color: #6B7280;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 6px 12px;
            font-size: 14px;
            cursor: pointer;
        }

        .search-term-highlight {
            background-color: #FFF9C4;
            padding: 2px 0;
        }

        [contenteditable="true"]:focus {
            outline: none;
            border-color: #3B82F6;
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="post-form-container">
        <h2>Content Compass</h2>
        <div>
            <label>Select the Content Database*</label>
            <select class="form-control" id="postType">
                <option value="square-help" selected>Square Help</option>
                <option value="squarewise">Google Drive</option>
                <option value="high-spot">High Spot</option>
            </select>
        </div>

        <div>
            <label>Search Your Topic</label>
            <input type="text" class="form-control" id="searchTopic" placeholder="address verification system">
            <button class="search-button" id="searchButton">Search</button>
        </div>

        <div id="searchResults" class="search-results"></div>
    </div>

    <script>
        // Updated Square Help content with all sections from the page
        const squareHelpContent = {
            articles: [
                {
                    title: "About Risk Manager",
                    content: "Risk Manager is a tool that helps you catch and manage online payments that pose a potential fraud risk. Creating a rule in Risk Manager allows you to select what actions can be taken on an online payment if certain conditions within that rule are met. Rules can either decline a payment from a specific payment card, trigger a risk alert, or invoke 3D Secure (3DS). Rules can be set based on payment card conditions as well.",
                    type: "section"
                },
                {
                    title: "Before you begin",
                    content: "Although this tool is designed to help prevent payment disputes, the risk of a payment dispute is present with all card payments. Sellers will continue to be liable for all payments they accept and the disputes they receive. Square is not assuming liability for payments, regardless of the risk evaluation that is delivered.\n\nThe only transactions affected by Risk Manager rules are online payments. Rules will not decline or trigger alerts on payments taken in person or via other payment methods such as Square Invoices and Virtual Terminal.",
                    type: "section"
                },
                {
                    title: "Step 1: Enable Risk Manager",
                    content: "1. Sign in to Square Dashboard and go to Orders & payments (or Invoices & Payments or Payments) > Risk manager.\n2. Click Get Started.\n3. Select the business location(s) you wish to activate with Risk Manager, then click Enroll in Risk Manager.\n\nOnce you have activated Risk Manager on your account, you can begin to create rules and set up alerts for your online payments.",
                    type: "section"
                },
                {
                    title: "Step 2: Create rules",
                    content: "A rule allows you to choose what happens to a payment if certain conditions are met. You can set a rule to either trigger a risk alert, invoke 3D Secure or to decline a payment. You can also set your rule to be based on factors such as Square's own risk evaluation, AVS mismatch, invalid CVV, or suspicious transaction amounts.\n\nWhen setting payment rules, if there are certain conditions of a payment that indicate suspicious behavior (i.e. a shipping address and billing address do not match), you can set a rule to take automatic action rather than manually reviewing each online payment.\n\nRule actions are ranked first by 3D Secure, Decline, and then Alert. If you have a payment that matches a 3D Secure rule and a decline rule, 3D Secure will take priority over the decline. And likewise, if you have a payment that hits both a decline rule and an alert rule, the decline will take priority over the alert.",
                    type: "section"
                },
                {
                    title: "Step 3: Review rule conditions",
                    content: "Rule conditions include:\n\n1. Address Verification System (AVS): Checks if the buyer's provided billing address matches the address on file with the card issuer.\n2. Card Verification Value (CVV): The 3-digit verification code on cards.\n3. Square's risk evaluation: Uses Square's payments data to determine fraud risk levels.\n4. Payment amount: Target rules based on transaction size.\n5. Payment velocity: Monitors repeat transactions on the same card.\n6. Prepaid payment cards: Higher risk due to non-traceability.\n7. International payment cards: Cards from countries different from your business location.\n8. Buyer IP address location: Checks if buyer's IP is outside your country.\n9. Shipping ZIP code: Compares shipping and billing ZIP codes.",
                    type: "section"
                },
                {
                    title: "Step 4: Set up your allow list",
                    content: "An Allow List in Risk Manager gives you more control and flexibility over the types of payments that can be processed at your business. Adding a payment card to your Allow List lets that payment card process a transaction at any of your business locations. A card on your Allow List will override any attempted declines by your Risk Manager rules and settings, your Block List, as well as any Square standard payment protections.",
                    type: "section"
                },
                {
                    title: "Step 5: Set up your block list",
                    content: "Blocking a card prevents that card from being used to make purchases with your business moving forward. If you identify what you believe to be a fraudulent transaction, you can take this action to prevent future payments being made with that card.",
                    type: "section"
                },
                {
                    title: "View risk alerts",
                    content: "Risk alerts allow you to view additional information regarding online payments that were flagged by risk rules that you created. In addition, default rules provided by Square will also trigger risk alerts. Risk alerts can help to determine whether flagged payments should be refunded to avoid disputes, as well as blocking a suspicious payment card from completing additional transactions with your business.\n\nYou can view payments that were flagged by alerts from your Square Dashboard by going to Payments > Risk Manager > Alerts.\n\nYou can view your declined payments from your Square Dashboard by going to Payments > Risk Manager > Blocked payments. You can also view which rule triggered a decline.",
                    type: "section"
                }
            ]
        };

        function saveContent(sectionTitle) {
            const contentDiv = document.querySelector(`[data-section="${sectionTitle}"]`);
            if (contentDiv) {
                const articleIndex = squareHelpContent.articles.findIndex(a => a.title === sectionTitle);
                if (articleIndex !== -1) {
                    squareHelpContent.articles[articleIndex].content = contentDiv.innerText;
                }
            }
        }

        function exportContent(sectionTitle) {
            const contentDiv = document.querySelector(`[data-section="${sectionTitle}"]`);
            if (contentDiv) {
                const content = contentDiv.innerText;
                const blob = new Blob([content], { type: 'text/plain' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `${sectionTitle.toLowerCase().replace(/\s+/g, '-')}.txt`;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
            }
        }

        function handleSearch() {
            const searchQuery = document.getElementById('searchTopic').value.trim();
            const resultsDiv = document.getElementById('searchResults');

            if (!searchQuery) {
                resultsDiv.innerHTML = '<div class="error-message">Please enter a search term</div>';
                return;
            }

            const searchTerms = searchQuery.toLowerCase().split(' ').filter(term => term.length > 0);
            const searchResults = [];

            squareHelpContent.articles.forEach(article => {
                const matches = searchTerms.every(term => 
                    article.content.toLowerCase().includes(term)
                );

                if (matches) {
                    searchResults.push({
                        title: article.title,
                        content: article.content,
                        type: article.type
                    });
                }
            });

            if (searchResults.length > 0) {
                resultsDiv.innerHTML = `
                    <h3>Search Results from Square Risk Manager Guide</h3>
                    <div class="search-summary">Found ${searchResults.length} matching sections</div>
                    ${searchResults.map(result => {
                        let highlightedContent = result.content;
                        searchTerms.forEach(term => {
                            const regex = new RegExp(`(${term})`, 'gi');
                            highlightedContent = highlightedContent.replace(regex, '<span class="search-term-highlight">$1</span>');
                        });
                        
                        return `
                            <div class="result-item">
                                <div class="result-section">${result.title}</div>
                                <div class="editable-content" contenteditable="true" data-section="${result.title}">${highlightedContent}</div>
                                <div class="result-type">${result.type}</div>
                                <div class="button-group">
                                    <button class="save-button" onclick="saveContent('${result.title}')">Save Changes</button>
                                    <button class="export-button" onclick="exportContent('${result.title}')">Export to Text</button>
                                </div>
                            </div>
                        `;
                    }).join('')}
                `;
            } else {
                resultsDiv.innerHTML = '<div class="no-results">No matching content found</div>';
            }
        }

        document.getElementById('searchButton').addEventListener('click', handleSearch);
        document.getElementById('searchTopic').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') handleSearch();
        });
    </script>
</body>
</html>